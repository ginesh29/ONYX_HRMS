@model IEnumerable<ActivityLogHead_Getrow_Result>
@{
    ViewData["Title"] = "Audit Log";
}
<div class="card">
    <div class="card-body">
        <table class="table table-sm" id="AuditDataTable">
            <thead class="thead-dark">
                <tr>
                    <th>No.</th>
                    <th>Activity Id</th>
                    <th>Activity By</th>
                    <th>Ip Adress</th>
                    <th>OS</th>
                    <th>Browser</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th></th>
                </tr>
            </thead>
            @foreach (var item in Model.Select((value, i) => new { i, value }))
            {
                <tr>
                    <td>@(item.i + 1)</td>
                    <td>@item.value.ActivityId</td>
                    <td>@item.value.UserCd</td>
                    <td>@item.value.IP</td>
                    <td>@item.value.OS</td>
                    <td>@item.value.Browser</td>
                    <td>@item.value.StartTime</td>
                    <td>@item.value.EndTime</td>
                    <td>
                        <button class="btn btn-sm btn-info ml-2" onclick="showActivityDetailModal('@item.value.ActivityId')">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                </tr>
            }
        </table>
    </div>
</div>
<div id="AuditDetailModal" class="modal fade" role="dialog" tabindex='-1'></div>
@section scripts {
    <script>
        $("#AuditDataTable").DataTable(dataTableDefaultOptions);
        function showActivityDetailModal(id) {
            $("#AuditDetailModal").load(`/Settings/AuditDetail?id=${id}`, function (response) {
                if ($.fn.DataTable.isDataTable('#AuditDetailDataTable'))
                    $('#AuditDetailDataTable').DataTable().destroy();
                var columnDefs = [
                    { "width": "10%", "targets": 0 },
                    { "width": "20%", "targets": 1 },
                    { "width": "70%", "targets": 2 }
                ];
                var options = dataTableDefaultOptions;
                options.columnDefs = columnDefs;
                $("#AuditDetailDataTable").DataTable(dataTableDefaultOptions);
                $("#AuditDetailModal").modal("show");
            });
        }
    </script>
}