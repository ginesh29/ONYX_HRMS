@{
    ViewData["Title"] = SharedResource["Display"];
}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
<link href="~/css/queue-display.css" rel="stylesheet" />
<div class="card maximized-card" id="display-card">
    <div class="card-header">
        <h3 class="card-title"></h3>
        <div class="card-tools">
            <button type="button" class="btn btn-tool d-none" data-card-widget="card-refresh" data-source="/Queue/DisplayPartial"><i class="fas fa-refresh" id="btn-refresh"></i></button>
            <button type="button" class="btn btn-tool" onclick="toggleFullscreen()"><i class="fas fa-expand"></i></button>
        </div>
    </div>
    <div class="card-body"></div>
</div>
@section scripts {
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
    <script src="~/lib/microsoft/signalr/dist/browser/signalr.min.js"></script>
    <script>
        var connection = new signalR.HubConnectionBuilder().withUrl("/chatHub").build();
        connection.on("ReceiveTokenCall", function (message, voiceName) {
            speak(message, voiceName);
        });
        connection.on("ReceiveRefreshCall", function () {
            $("#btn-refresh").click();
        });
        connection.on("ReceiveTokenAddCall", function () {
            $("#btn-refresh").click();
        });
        connection.start();

        function toggleFullscreen() {
            const elem = document.documentElement;
            if (!document.fullscreenElement) {
                elem.requestFullscreen();
                $('body').addClass('fullscreen');
                $("#carousel").addClass("position-fixed");
            }
            else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    $('body').removeClass('fullscreen');
                    $("#carousel").removeClass("position-fixed")
                }
            }
        }
        function onEscapeKeyDown(event) {
            if (event.key === "Escape")
                if (document.fullscreenElement)
                    document.exitFullscreen();
        }
        document.addEventListener('fullscreenchange', (event) => {
            if (!document.fullscreenElement) {
                $('body').removeClass('fullscreen');
                $("#carousel").removeClass("position-fixed")
                $(document).off('keydown', onEscapeKeyDown);
            }
        });
    </script>
}